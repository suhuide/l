
[ITX-3588J](https://www.t-firefly.com/doc/download/160.html)  
[Core-3588J-Manual](https://wiki.t-firefly.com/zh_CN/Core-3588J/index.html)  
3.2.1. 整体编译  
3.2.1.1. HDMI 固件编译  
./FFTools/make.sh-drk3588-firefly-itx-3588j-j8-lrk3588_firefly_itx_3588j-userdebug  
./FFTools/mkupdate/mkupdate.sh-lrk3588_firefly_itx_3588j-userdebug  
3.2.1.2. 显示屏 DM-M10R800 V2 固件编译：  
./FFTools/make.sh-drk3588-firefly-itx-3588j-mipi101-M101014-BE45-A1-j8-lrk3588_firefly_itx_3588j_mipi-userdebug  
./FFTools/mkupdate/mkupdate.sh-lrk3588_firefly_itx_3588j_mipi-userdebug 

log
```c
eric@ubuntu:~$ sudo apt-get update
eric@ubuntu:~$ sudo apt-get install git gnupg flex bison gperf libsdl1.2-dev \
 libesd-java libwxgtk3.0-dev squashfs-tools build-essential zip curl \
 libncurses5-dev zlib1g-dev pngcrush schedtool libxml2 libxml2-utils \
 xsltproc lzop libc6-dev schedtool g++-multilib lib32z1-dev lib32ncurses5-dev \
 lib32readline-dev gcc-multilib libswitch-perl libssl-dev unzip zip device-tree-compiler \
 liblz4-tool python-pyelftools python3-pyelftools -y
eric@ubuntu:~$ sudo apt install p7zip-full p7zip-rar
eric@ubuntu:~$ cd proj/
eric@ubuntu:~/proj$ 7z x ./firefly_rk3588_android12.0_git_20220311/firefly_rk3588_android12.0_git_20220311.7z.001 -oRK3588_Android12.0
eric@ubuntu:~/proj$ cd ./RK3588_Android12.0
eric@ubuntu:~/proj/RK3588_Android12.0$ git reset --hard
Checking out files: 100% (1070040/1070040), done.
HEAD is now at 8e56b0277c Init Firefly RK3588 Android12.0 SDK
eric@ubuntu:~/proj/RK3588_Android12.0$ 7z x rk3588-android12.0-bundle.7z -r -o. && mv rk3588-android12.0-bundle .bundle
eric@ubuntu:~/proj/RK3588_Android12.0$ git rebase FETCH_HEAD
fatal: Needed a single revision
invalid upstream 'FETCH_HEAD'
eric@ubuntu:~/proj/RK3588_Android12.0$ .bundle/update
...
From .bundle/6.bundle
* branch HEAD -> FETCH_HEAD
[Info]Fetch .bundle/6.bundle successfully!!
eric@ubuntu:~/proj/RK3588_Android12.0$ git rebase FETCH_HEAD
First, rewinding head to replay your work on top of it...
Fast-forwarded firefly to FETCH_HEAD.
eric@ubuntu:~/proj/RK3588_Android12.0$ git log
commit e12ba531a1ef63b99ce4d8b17b9daf2ea30f69ec (HEAD -> firefly)
Author: Firefly <service@t-firefly.com>
Date: Thu Apr 6 19:58:02 2023 +0800
eric@ubuntu:~/proj/RK3588_Android12.0$ git checkout aba91242aea56a31d392bde144ea1478dfbdb437
eric@ubuntu:~/proj/RK3588_Android12.0$ ./FFTools/make.sh -d rk3588-firefly-itx-3588j -j14 -l rk3588_firefly_itx_3588j-userdebug
eric@ubuntu:~/proj/RK3588_Android12.0$ ./FFTools/mkupdate/mkupdate.sh -l rk3588_firefly_itx_3588j-userdebug
eric@ubuntu:~/proj/RK3588_Android12.0$ ./FFTools/make.sh -d rk3588-firefly-itx-3588j-mipi101-M101014-BE45-A1 -j14 -l rk3588_firefly_itx_3588j_mipi-userdebug
eric@ubuntu:~/proj/RK3588_Android12.0$ ./FFTools/mkupdate/mkupdate.sh -l rk3588_firefly_itx_3588j_mipi-userdebug
eric@ubuntu:~/proj/RK3588_Android12.0$ sudo upgrade_tool UF ./rockdev/Image-rk3588_firefly_itx_3588j_mipi/ITX-3588J_Android12_MIPI_230709.img
```

# update.img
在 RK3588 的开发流程中，一般会生成一个名为 update.img 的固件文件。  
这是一个“统一固件（unified firmware）”，将多个关键组件打包合并到了一个镜像中，之前我们可能要按照好几步复杂的调试进行烧写，现在不用了  
该镜像包含了：分区表（partition table）、bootloader、uboot、kernel、system（文件系统） 等多个镜像或系统组件  
update.img 用于通过 USB（如 RKDevTool 等工具）整体烧写设备；这会清掉板上所有分区数据，因此适用于首次烧录或完整刷新  
# 常见组件镜像与用途
## 1. uboot.img
用途：这是 U-Boot 启动引导程序，用于初始化硬件、加载后续引导阶段（如 Bootloader stage 2）、并最终引导内核启动。
应用：用于修复或更新启动链中的核心部分，在设备启动失败或 U-Boot 出错时特别有用。可以单独使用 upgrade_tool di -uboot uboot.img 来烧写
## 2. kernel.img
用途：Linux 内核镜像。包含内核本身及其驱动程序。
应用：在需要更新驱动或内核版本时，通过 upgrade_tool di -boot boot.img（有时是 -kernel）单独刷写 Kernel 分区即可
## 3. boot.img
用途：通常包含了内核加上一些初始文件系统（比如 ramdisk），在 Android 平台特别常见。
应用：用于同时更新内核与系统启动时所需文件。刷写命令同样适用 -boot 或按工具界面中选择 boot 分区
## 4. recovery.img
用途：Recovery 模式下使用的镜像，包含恢复环境及逻辑，可用于执行 OTA、格式化、系统修复等。
应用：在设备启动到 recovery 模式时生效，可通过恢复镜像单独更新。
## 5. misc.img
用途：Misc 分区通常存储一些系统标志、启动控制协议（boot control flags），例如 recovery 模式触发标志等。
应用：不建议在刷机包中频繁包含 misc 分区，因为更新过程中可能清除这些重要标志，导致系统行为异常
## 6. rootfs.img
用途：根文件系统镜像，包含实际的操作系统环境（Linux 或 Android 的用户空间文件、应用和配置等）。
应用：当系统层发生变化（如软件更新、应用安装、文件结构调整）时，更新此分区即可。SDK 打包中常作为一个 partition 被整合进 update.img
## 7. resource.img / parameter.img / dtbo.img / oem.img / userdata.img
用途：
resource.img：包含设备资源信息，如屏幕分辨率、按键映射、布局配置等。  
parameter.img：可能存储启动参数、设备配置等。  
dtbo.img：设备拓展版的设备树 overlay（Device Tree Blob Overlay）。  
oem.img：厂商定制内容。  
userdata.img：用户数据分区，包含用户生成内容。  
应用：这些镜像通常用于高度定制化更新或调试。  
常在 package-file 中通过注释启用/禁用某个分区的升级，以控制更新范围

## 总结说明表

| 镜像文件  | 功能说明 |
| ----  |  ---- |
|uboot.img	| 更新启动引导器 U-Boot |
|kernel.img	| 更新 Linux 内核镜像 |
|boot.img	| 包含内核和启动时的初始文件系统（特别在 Android 中） |
|recovery.img	| 更新恢复模式逻辑，用于 OTA 或故障修复 |
|misc.img	| 存储启动标志，不建议频繁更新 |
|rootfs.img	| 全系统根文件系统；更新用户空间内容 |
|resource.img etc.	| 存储设备资源、参数、overlay、厂商定制、用户数据等特定内容 | 